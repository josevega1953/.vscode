"use strict";exports.id=835,exports.ids=[835],exports.modules={11652(e,t,r){r.d(t,{y:()=>c});const n={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function o(e={}){let t=new s(e.parentContext);return e.span&&(t=t.setValue(n.span,e.span)),e.namespace&&(t=t.setValue(n.namespace,e.namespace)),t}class s{_contextMap;constructor(e){this._contextMap=e instanceof s?new Map(e._contextMap):new Map}setValue(e,t){const r=new s(this);return r._contextMap.set(e,t),r}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new s(this);return t._contextMap.delete(e),t}}const a=r(12583).state;function i(){return a.instrumenterImplementation||(a.instrumenterImplementation={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{},addEvent:()=>{}},tracingContext:o({parentContext:t.tracingContext})}),withContext:(e,t,...r)=>t(...r)}),a.instrumenterImplementation}function c(e){const{namespace:t,packageName:r,packageVersion:o}=e;function s(e,s,a){const c=i().startSpan(e,{...a,packageName:r,packageVersion:o,tracingContext:s?.tracingOptions?.tracingContext});let u=c.tracingContext;const l=c.span;return u.getValue(n.namespace)||(u=u.setValue(n.namespace,t)),l.setAttribute("az.namespace",u.getValue(n.namespace)),{span:l,updatedOptions:Object.assign({},s,{tracingOptions:{...s?.tracingOptions,tracingContext:u}})}}function a(e,t,...r){return i().withContext(e,t,...r)}return{startSpan:s,withSpan:async function(e,t,r,n){const{span:o,updatedOptions:i}=s(e,t,n);try{const e=await a(i.tracingOptions.tracingContext,()=>Promise.resolve(r(i,o)));return o.setStatus({status:"success"}),e}catch(e){throw o.setStatus({status:"error",error:e}),e}finally{o.end()}},withContext:a,parseTraceparentHeader:function(e){return i().parseTraceparentHeader(e)},createRequestHeaders:function(e){return i().createRequestHeaders(e)}}}},14338(e,t,r){r.d(t,{Bd:()=>n,N6:()=>s,Qg:()=>a,lV:()=>u,p7:()=>o,qx:()=>i,tX:()=>c});const n="undefined"!=typeof window&&void 0!==window.document,o="object"==typeof self&&"function"==typeof self?.importScripts&&("DedicatedWorkerGlobalScope"===self.constructor?.name||"ServiceWorkerGlobalScope"===self.constructor?.name||"SharedWorkerGlobalScope"===self.constructor?.name),s="undefined"!=typeof Deno&&void 0!==Deno.version&&void 0!==Deno.version.deno,a="undefined"!=typeof Bun&&void 0!==Bun.version,i=void 0!==globalThis.process&&Boolean(globalThis.process.version)&&Boolean(globalThis.process.versions?.node),c=i&&!a&&!s,u="undefined"!=typeof navigator&&"ReactNative"===navigator?.product},38414(e,t,r){r.d(t,{If:()=>a.I,gE:()=>n.g,Bd:()=>s.Bd,Qg:()=>s.Qg,N6:()=>s.N6,bJ:()=>o.b,qx:()=>s.qx,tX:()=>s.tX,lV:()=>s.lV,p7:()=>s.p7});var n=r(61051),o=r(70761);r(77598);var s=r(14338),a=r(97247)},42816(e,t,r){r.d(t,{l:()=>n});class n extends Error{constructor(e){super(e),this.name="AbortError"}}},44835(e,t,r){r.d(t,{pj:()=>ve,N$:()=>ke,uQ:()=>Te,fl:()=>Ee,createHttpHeaders:()=>xe,Fp:()=>Pe,createPipelineRequest:()=>Ce,Jb:()=>Oe});class n extends Error{constructor(e){super(e),this.name="AbortError"}}var o=r(75666);function s(e){return e.toLowerCase()}class a{_headersMap;constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(s(e),{name:e,value:String(t).trim()})}get(e){return this._headersMap.get(s(e))?.value}has(e){return this._headersMap.has(s(e))}delete(e){this._headersMap.delete(s(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const e of this._headersMap.values())t[e.name]=e.value;else for(const[e,r]of this._headersMap)t[e]=r.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function i(e){return new a(e)}function c(){return crypto.randomUUID()}class u{url;method;headers;timeout;withCredentials;body;multipartBody;formData;streamResponseStatusCodes;enableBrowserStreams;proxySettings;disableKeepAlive;abortSignal;requestId;allowInsecureConnection;onUploadProgress;onDownloadProgress;requestOverrides;authSchemes;constructor(e){this.url=e.url,this.body=e.body,this.headers=e.headers??i(),this.method=e.method??"GET",this.timeout=e.timeout??0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=e.disableKeepAlive??!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=e.withCredentials??!1,this.abortSignal=e.abortSignal,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||c(),this.allowInsecureConnection=e.allowInsecureConnection??!1,this.enableBrowserStreams=e.enableBrowserStreams??!1,this.requestOverrides=e.requestOverrides,this.authSchemes=e.authSchemes}}const l=new Set(["Deserialize","Serialize","Retry","Sign"]);class d{_policies=[];_orderedPolicies;constructor(e){this._policies=e?.slice(0)??[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!l.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!l.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter(r=>!(e.name&&r.policy.name===e.name||e.phase&&r.options.phase===e.phase)||(t.push(r.policy),!1)),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight((e,t)=>r=>t.sendRequest(r,e),t=>e.sendRequest(t))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new d(this._policies)}static create(){return new d}orderPolicies(){const e=[],t=new Map;function r(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const n=r("Serialize"),o=r("None"),s=r("Deserialize"),a=r("Retry"),i=r("Sign"),c=[n,o,s,a,i];function u(e){return"Retry"===e?a:"Serialize"===e?n:"Deserialize"===e?s:"Sign"===e?i:o}for(const e of this._policies){const r=e.policy,n=e.options,o=r.name;if(t.has(o))throw new Error("Duplicate policy names not allowed in pipeline");const s={policy:r,dependsOn:new Set,dependants:new Set};n.afterPhase&&(s.afterPhase=u(n.afterPhase),s.afterPhase.hasAfterPolicies=!0),t.set(o,s),u(n.phase).policies.add(s)}for(const e of this._policies){const{policy:r,options:n}=e,o=r.name,s=t.get(o);if(!s)throw new Error(`Missing node for policy ${o}`);if(n.afterPolicies)for(const e of n.afterPolicies){const r=t.get(e);r&&(s.dependsOn.add(r),r.dependants.add(s))}if(n.beforePolicies)for(const e of n.beforePolicies){const r=t.get(e);r&&(r.dependsOn.add(s),s.dependants.add(r))}}function l(r){r.hasRun=!0;for(const n of r.policies)if((!n.afterPhase||n.afterPhase.hasRun&&!n.afterPhase.policies.size)&&0===n.dependsOn.size){e.push(n.policy);for(const e of n.dependants)e.dependsOn.delete(n);t.delete(n.policy.name),r.policies.delete(n)}}function d(){for(const e of c){if(l(e),e.policies.size>0&&e!==o)return void(o.hasRun||l(o));e.hasAfterPolicies&&l(o)}}let f=0;for(;t.size>0;){f++;const t=e.length;if(d(),e.length<=t&&f>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}var f=r(70761);const p=r(57975).inspect.custom;var h=r(97247);const g=new h.I;class y extends Error{static REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";static PARSE_ERROR="PARSE_ERROR";code;statusCode;request;response;details;constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1});const r=this.request?.agent?{maxFreeSockets:this.request.agent.maxFreeSockets,maxSockets:this.request.agent.maxSockets}:void 0;Object.defineProperty(this,p,{value:()=>`RestError: ${this.message} \n ${g.sanitize({...this,request:{...this.request,agent:r},response:this.response})}`,enumerable:!1}),Object.setPrototypeOf(this,y.prototype)}}var m=r(37067),w=r(44708),b=r(38522),v=r(57075);const R=(0,o.KV)("ts-http-runtime"),S={};function A(e){return e&&"function"==typeof e.pipe}function P(e){return!1===e.readable?Promise.resolve():new Promise(t=>{const r=()=>{t(),e.removeListener("close",r),e.removeListener("end",r),e.removeListener("error",r)};e.on("close",r),e.on("end",r),e.on("error",r)})}function E(e){return e&&"number"==typeof e.byteLength}class x extends v.Transform{loadedBytes=0;progressCallback;_transform(e,t,r){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),r()}catch(e){r(e)}}constructor(e){super(),this.progressCallback=e}}class C{cachedHttpAgent;cachedHttpsAgents=new WeakMap;async sendRequest(e){const t=new AbortController;let r,o;if(e.abortSignal){if(e.abortSignal.aborted)throw new n("The operation was aborted. Request has already been canceled.");r=e=>{"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",r)}e.timeout>0&&(o=setTimeout(()=>{const r=new h.I;R.info(`request to '${r.sanitizeUrl(e.url)}' timed out. canceling...`),t.abort()},e.timeout));const s=e.headers.get("Accept-Encoding"),a=s?.includes("gzip")||s?.includes("deflate");let c,u="function"==typeof e.body?e.body():e.body;if(u&&!e.headers.has("Content-Length")){const t=function(e){return e?Buffer.isBuffer(e)?e.length:A(e)?null:E(e)?e.byteLength:"string"==typeof e?Buffer.from(e).length:null:0}(u);null!==t&&e.headers.set("Content-Length",t)}try{if(u&&e.onUploadProgress){const t=e.onUploadProgress,r=new x(t);r.on("error",e=>{R.error("Error in upload progress",e)}),A(u)?u.pipe(r):r.end(u),u=r}const r=await this.makeRequest(e,t,u);void 0!==o&&clearTimeout(o);const n=function(e){const t=i();for(const r of Object.keys(e.headers)){const n=e.headers[r];Array.isArray(n)?n.length>0&&t.set(r,n[0]):n&&t.set(r,n)}return t}(r),s={status:r.statusCode??0,headers:n,request:e};if("HEAD"===e.method)return r.resume(),s;c=a?function(e,t){const r=t.get("Content-Encoding");if("gzip"===r){const t=b.createGunzip();return e.pipe(t),t}if("deflate"===r){const t=b.createInflate();return e.pipe(t),t}return e}(r,n):r;const d=e.onDownloadProgress;if(d){const e=new x(d);e.on("error",e=>{R.error("Error in download progress",e)}),c.pipe(e),c=e}return e.streamResponseStatusCodes?.has(Number.POSITIVE_INFINITY)||e.streamResponseStatusCodes?.has(s.status)?s.readableStreamBody=c:s.bodyAsText=await(l=c,new Promise((e,t)=>{const r=[];l.on("data",e=>{Buffer.isBuffer(e)?r.push(e):r.push(Buffer.from(e))}),l.on("end",()=>{e(Buffer.concat(r).toString("utf8"))}),l.on("error",e=>{t(e&&"AbortError"===e?.name?e:new y(`Error reading response as text: ${e.message}`,{code:y.PARSE_ERROR}))})})),s}finally{if(e.abortSignal&&r){let t=Promise.resolve();A(u)&&(t=P(u));let n=Promise.resolve();A(c)&&(n=P(c)),Promise.all([t,n]).then(()=>{r&&e.abortSignal?.removeEventListener("abort",r)}).catch(e=>{R.warning("Error when cleaning up abortListener on httpRequest",e)})}}var l}makeRequest(e,t,r){const o=new URL(e.url),s="https:"!==o.protocol;if(s&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);const a={agent:e.agent??this.getOrCreateAgent(e,s),hostname:o.hostname,path:`${o.pathname}${o.search}`,port:o.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0}),...e.requestOverrides};return new Promise((o,i)=>{const c=s?m.request(a,o):w.request(a,o);c.once("error",t=>{i(new y(t.message,{code:t.code??y.REQUEST_SEND_ERROR,request:e}))}),t.signal.addEventListener("abort",()=>{const e=new n("The operation was aborted. Rejecting from abort signal callback while making request.");c.destroy(e),i(e)}),r&&A(r)?r.pipe(c):r?"string"==typeof r||Buffer.isBuffer(r)?c.end(r):E(r)?c.end(ArrayBuffer.isView(r)?Buffer.from(r.buffer):Buffer.from(r)):(R.error("Unrecognized body type",r),i(new y("Unrecognized body type"))):c.end()})}getOrCreateAgent(e,t){const r=e.disableKeepAlive;if(t)return r?m.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new m.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(r&&!e.tlsSettings)return w.globalAgent;const t=e.tlsSettings??S;let n=this.cachedHttpsAgents.get(t);return n&&n.options.keepAlive===!r||(R.info("No cached TLS Agent exist, creating a new Agent"),n=new w.Agent({keepAlive:!r,...t}),this.cachedHttpsAgents.set(t,n)),n}}}var q=r(48161),O=r(1708),$=r(61051);function T(e,t,r){return new Promise((o,s)=>{let a,i;const c=()=>s(new n(r?.abortErrorMsg?r?.abortErrorMsg:"The operation was aborted.")),u=()=>{r?.abortSignal&&i&&r.abortSignal.removeEventListener("abort",i)};if(i=()=>(a&&clearTimeout(a),u(),c()),r?.abortSignal&&r.abortSignal.aborted)return c();a=setTimeout(()=>{u(),o(t)},e),r?.abortSignal&&r.abortSignal.addEventListener("abort",i)})}function L(e,t){const r=e.headers.get(t);if(!r)return;const n=Number(r);return Number.isNaN(n)?void 0:n}const M="Retry-After",I=["retry-after-ms","x-ms-retry-after-ms",M];function N(e){if(e&&[429,503].includes(e.status))try{for(const t of I){const r=L(e,t);if(0===r||r)return r*(t===M?1e3:1)}const t=e.headers.get(M);if(!t)return;const r=Date.parse(t)-Date.now();return Number.isFinite(r)?Math.max(0,r):void 0}catch{return}}function k(e={}){const t=e.retryDelayInMs??1e3,r=e.maxRetryDelayInMs??64e3;return{name:"exponentialRetryStrategy",retry({retryCount:n,response:o,responseError:s}){const a=!!(d=s)&&("ETIMEDOUT"===d.code||"ESOCKETTIMEDOUT"===d.code||"ECONNREFUSED"===d.code||"ECONNRESET"===d.code||"ENOENT"===d.code||"ENOTFOUND"===d.code),i=a&&e.ignoreSystemErrors,c=function(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(o),u=c&&e.ignoreHttpStatusCodes,l=o&&(function(e){return Number.isFinite(N(e))}(o)||!c);var d;return l||u||i?{skipStrategy:!0}:!s||a||c?(0,$.g)(n,{retryDelayInMs:t,maxRetryDelayInMs:r}):{errorToThrow:s}}}}const D=(0,o.KV)("ts-http-runtime retryPolicy");function _(e,t={maxRetries:3}){const r=t.logger||D;return{name:"retryPolicy",async sendRequest(o,s){let a,i,c=-1;e:for(;;){c+=1,a=void 0,i=void 0;try{r.info(`Retry ${c}: Attempting to send request`,o.requestId),a=await s(o),r.info(`Retry ${c}: Received a response from request`,o.requestId)}catch(e){if(r.error(`Retry ${c}: Received an error from request`,o.requestId),i=e,!e||"RestError"!==i.name)throw e;a=i.response}if(o.abortSignal?.aborted)throw r.error(`Retry ${c}: Request aborted.`),new n;if(c>=(t.maxRetries??3)){if(r.info(`Retry ${c}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),i)throw i;if(a)return a;throw new Error("Maximum retries reached with no response or error to throw")}r.info(`Retry ${c}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||r;e.info(`Retry ${c}: Processing retry strategy ${t.name}.`);const n=t.retry({retryCount:c,response:a,responseError:i});if(n.skipStrategy){e.info(`Retry ${c}: Skipped.`);continue t}const{errorToThrow:s,retryAfterInMs:u,redirectTo:l}=n;if(s)throw e.error(`Retry ${c}: Retry strategy ${t.name} throws error:`,s),s;if(u||0===u){e.info(`Retry ${c}: Retry strategy ${t.name} retries after ${u}`),await T(u,void 0,{abortSignal:o.abortSignal});continue e}if(l){e.info(`Retry ${c}: Retry strategy ${t.name} redirects to ${l}`),o.url=l;continue e}}if(i)throw r.info("None of the retry strategies could work with the received error. Throwing it."),i;if(a)return r.info("None of the retry strategies could work with the received response. Returning it."),a}}}}function B(e,t){return Buffer.from(e,t)}var z=r(14338);var U=r(62288),H=r(6645);const W=[];let V=!1;const j=new Map;function Q(e){return process.env[e]?process.env[e]:process.env[e.toLowerCase()]?process.env[e.toLowerCase()]:void 0}function G(e){let t;try{t=new URL(e.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${e.host}".`)}return t.port=String(e.port),e.username&&(t.username=e.username),e.password&&(t.password=e.password),t}function F(e,t,r){if(e.agent)return;const n="https:"!==new URL(e.url).protocol;e.tlsSettings&&R.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");const o=e.headers.toJSON();n?(t.httpProxyAgent||(t.httpProxyAgent=new H.HttpProxyAgent(r,{headers:o})),e.agent=t.httpProxyAgent):(t.httpsProxyAgent||(t.httpsProxyAgent=new U.HttpsProxyAgent(r,{headers:o})),e.agent=t.httpsProxyAgent)}function J(e,t){V||W.push(...function(){const e=Q("NO_PROXY");return V=!0,e?e.split(",").map(e=>e.trim()).filter(e=>e.length):[]}());const r=e?G(e):function(){const e=function(){if(!process)return;const e=Q("HTTPS_PROXY"),t=Q("ALL_PROXY"),r=Q("HTTP_PROXY");return e||t||r}();return e?new URL(e):void 0}(),n={};return{name:"proxyPolicy",sendRequest:async(e,o)=>(e.proxySettings||!r||function(e,t,r){if(0===t.length)return!1;const n=new URL(e).hostname;if(r?.has(n))return r.get(n);let o=!1;for(const e of t)"."===e[0]?(n.endsWith(e)||n.length===e.length-1&&n===e.slice(1))&&(o=!0):n===e&&(o=!0);return r?.set(n,o),o}(e.url,t?.customNoProxyList??W,t?.customNoProxyList?void 0:j)?e.proxySettings&&F(e,n,G(e.proxySettings)):F(e,n,r),o(e))}}function K(e){return"function"==typeof e.stream}var X=r(2203);async function*Y(){const e=this.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)return;yield r}}finally{e.releaseLock()}}function Z(e){return e instanceof ReadableStream?((t=e)[Symbol.asyncIterator]||(t[Symbol.asyncIterator]=Y.bind(t)),t.values||(t.values=Y.bind(t)),X.Readable.fromWeb(e)):e;var t}function ee(e){return e instanceof Uint8Array?X.Readable.from(Buffer.from(e)):K(e)?Z(e.stream()):Z(e)}function te(e){let t="";for(const[r,n]of e)t+=`${r}: ${n}\r\n`;return t}function re(e){return e instanceof Uint8Array?e.byteLength:K(e)?-1===e.size?void 0:e.size:void 0}const ne="multipartPolicy",oe=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function se(){return{name:ne,async sendRequest(e,t){if(!e.multipartBody)return t(e);if(e.body)throw new Error("multipartBody and regular body cannot be set at the same time");let r=e.multipartBody.boundary;const n=e.headers.get("Content-Type")??"multipart/mixed",o=n.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!o)throw new Error(`Got multipart request body, but content-type header was not multipart: ${n}`);const[,s,a]=o;if(a&&r&&a!==r)throw new Error(`Multipart boundary was specified as ${a} in the header, but got ${r} in the request body`);return r??=a,r?function(e){if(e.length>70)throw new Error(`Multipart boundary "${e}" exceeds maximum length of 70 characters`);if(Array.from(e).some(e=>!oe.has(e)))throw new Error(`Multipart boundary "${e}" contains invalid characters`)}(r):r=`----AzSDKFormBoundary${c()}`,e.headers.set("Content-Type",`${s}; boundary=${r}`),await async function(e,t,r){const n=[B(`--${r}`,"utf-8"),...t.flatMap(e=>[B("\r\n","utf-8"),B(te(e.headers),"utf-8"),B("\r\n","utf-8"),e.body,B(`\r\n--${r}`,"utf-8")]),B("--\r\n\r\n","utf-8")],o=function(e){let t=0;for(const r of e){const e=re(r);if(void 0===e)return;t+=e}return t}(n);o&&e.headers.set("Content-Length",o),e.body=await async function(e){return function(){const t=e.map(e=>"function"==typeof e?e():e).map(ee);return X.Readable.from(async function*(){for(const e of t)for await(const t of e)yield t}())}}(n)}(e,e.multipartBody.parts,r),e.multipartBody=void 0,t(e)}}}var ae=r(69325);const ie=(0,ae.KV)("core-rest-pipeline"),ce=["GET","HEAD"];function ue(e={}){const{maxRetries:t=20}=e;return{name:"redirectPolicy",async sendRequest(e,r){const n=await r(e);return le(r,n,t)}}}async function le(e,t,r,n=0){const{request:o,status:s,headers:a}=t,i=a.get("location");if(i&&(300===s||301===s&&ce.includes(o.method)||302===s&&ce.includes(o.method)||303===s&&"POST"===o.method||307===s)&&n<r){const t=new URL(i,o.url);o.url=t.toString(),303===s&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");const a=await e(o);return le(e,a,r,n+1)}return t}const de="1.22.2";async function fe(e){const t=new Map;t.set("core-rest-pipeline",de),await async function(e){if(O&&O.versions){const t=`${q.type()} ${q.release()}; ${q.arch()}`,r=O.versions;r.bun?e.set("Bun",`${r.bun} (${t})`):r.deno?e.set("Deno",`${r.deno} (${t})`):r.node&&e.set("Node",`${r.node} (${t})`)}}(t);const r=function(e){const t=[];for(const[r,n]of e){const e=n?`${r}/${n}`:r;t.push(e)}return t.join(" ")}(t);return e?`${e} ${r}`:r}const pe="User-Agent";var he=r(67715);const ge=Symbol("rawContent");function ye(e){return"function"==typeof e[ge]}function me(e){return ye(e)?e[ge]():e}const we=ne;var be=r(11652);const ve=y;function Re(e){return function(e){return e instanceof y||(0,f.b)(e)&&"RestError"===e.name}(e)}var Se=r(38414);function Ae(e){if(e instanceof AbortSignal)return{abortSignal:e};if(e.aborted)return{abortSignal:AbortSignal.abort(e.reason)};const t=new AbortController;let r=!0;function n(){r&&(e.removeEventListener("abort",o),r=!1)}function o(){t.abort(e.reason),n()}return e.addEventListener("abort",o),{abortSignal:t.signal,cleanup:n}}function Pe(e){const t=d.create();return he.qx&&(e.agent&&t.addPolicy((n=e.agent,{name:"agentPolicy",sendRequest:async(e,t)=>(e.agent||(e.agent=n),t(e))})),e.tlsOptions&&t.addPolicy((r=e.tlsOptions,{name:"tlsPolicy",sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=r),t(e))})),t.addPolicy(J(e.proxyOptions,void 0)),t.addPolicy({name:"decompressResponsePolicy",sendRequest:async(e,t)=>("HEAD"!==e.method&&e.headers.set("Accept-Encoding","gzip,deflate"),t(e))})),t.addPolicy({name:"wrapAbortSignalLikePolicy",sendRequest:async(e,t)=>{if(!e.abortSignal)return t(e);const{abortSignal:r,cleanup:n}=Ae(e.abortSignal);e.abortSignal=r;try{return await t(e)}finally{n?.()}}}),t.addPolicy({name:"formDataPolicy",async sendRequest(e,t){if(z.qx&&"undefined"!=typeof FormData&&e.body instanceof FormData&&(e.formData=function(e){const t={};for(const[r,n]of e.entries())t[r]??=[],t[r].push(n);return t}(e.body),e.body=void 0),e.formData){const t=e.headers.get("Content-Type");t&&-1!==t.indexOf("application/x-www-form-urlencoded")?e.body=function(e){const t=new URLSearchParams;for(const[r,n]of Object.entries(e))if(Array.isArray(n))for(const e of n)t.append(r,e.toString());else t.append(r,n.toString());return t.toString()}(e.formData):await async function(e,t){const r=t.headers.get("Content-Type");if(r&&!r.startsWith("multipart/form-data"))return;t.headers.set("Content-Type",r??"multipart/form-data");const n=[];for(const[t,r]of Object.entries(e))for(const e of Array.isArray(r)?r:[r])if("string"==typeof e)n.push({headers:i({"Content-Disposition":`form-data; name="${t}"`}),body:B(e,"utf-8")});else{if(null==e||"object"!=typeof e)throw new Error(`Unexpected value for key ${t}: ${e}. Value should be serialized to string first.`);{const r=e.name||"blob",o=i();o.set("Content-Disposition",`form-data; name="${t}"; filename="${r}"`),o.set("Content-Type",e.type||"application/octet-stream"),n.push({headers:o,body:e})}}t.multipartBody={parts:n}}(e.formData,e),e.formData=void 0}return t(e)}},{beforePolicies:[we]}),t.addPolicy(function(e={}){const t=fe(e.userAgentPrefix);return{name:"userAgentPolicy",sendRequest:async(e,r)=>(e.headers.has(pe)||e.headers.set(pe,await t),r(e))}}(e.userAgentOptions)),t.addPolicy(function(e="x-ms-client-request-id"){return{name:"setClientRequestIdPolicy",sendRequest:async(t,r)=>(t.headers.has(e)||t.headers.set(e,t.requestId),r(t))}}(e.telemetryOptions?.clientRequestIdHeaderName)),t.addPolicy(function(){const e=se();return{name:we,sendRequest:async(t,r)=>{if(t.multipartBody)for(const e of t.multipartBody.parts)ye(e.body)&&(e.body=me(e.body));return e.sendRequest(t,r)}}}(),{afterPhase:"Deserialize"}),t.addPolicy(function(e={}){return function(e={}){return{name:"defaultRetryPolicy",sendRequest:_([{name:"throttlingRetryStrategy",retry({response:e}){const t=N(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}},k(e)],{maxRetries:e.maxRetries??3}).sendRequest}}(e)}(e.retryOptions),{phase:"Retry"}),t.addPolicy(function(e={}){const t=fe(e.userAgentPrefix),r=new Se.If({additionalAllowedQueryParameters:e.additionalAllowedQueryParameters}),n=function(){try{return(0,be.y)({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:de})}catch(e){return void ie.warning(`Error when creating the TracingClient: ${(0,he.u1)(e)}`)}}();return{name:"tracingPolicy",async sendRequest(e,o){if(!n)return o(e);const s=await t,a={"http.url":r.sanitizeUrl(e.url),"http.method":e.method,"http.user_agent":s,requestId:e.requestId};s&&(a["http.user_agent"]=s);const{span:i,tracingContext:c}=function(e,t,r){try{const{span:n,updatedOptions:o}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:r});if(!n.isRecording())return void n.end();const s=e.createRequestHeaders(o.tracingOptions.tracingContext);for(const[e,r]of Object.entries(s))t.headers.set(e,r);return{span:n,tracingContext:o.tracingOptions.tracingContext}}catch(e){return void ie.warning(`Skipping creating a tracing span due to an error: ${(0,he.u1)(e)}`)}}(n,e,a)??{};if(!i||!c)return o(e);try{const t=await n.withContext(c,o,e);return function(e,t){try{e.setAttribute("http.status_code",t.status);const r=t.headers.get("x-ms-request-id");r&&e.setAttribute("serviceRequestId",r),t.status>=400&&e.setStatus({status:"error"}),e.end()}catch(e){ie.warning(`Skipping tracing span processing due to an error: ${(0,he.u1)(e)}`)}}(i,t),t}catch(e){throw function(e,t){try{e.setStatus({status:"error",error:(0,he.bJ)(t)?t:void 0}),Re(t)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(e){ie.warning(`Skipping tracing span processing due to an error: ${(0,he.u1)(e)}`)}}(i,e),e}}}}({...e.userAgentOptions,...e.loggingOptions}),{afterPhase:"Retry"}),he.qx&&t.addPolicy(function(e={}){return ue(e)}(e.redirectOptions),{afterPhase:"Retry"}),t.addPolicy(function(e={}){return function(e={}){const t=e.logger??R.info,r=new h.I({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:"logPolicy",async sendRequest(e,n){if(!t.enabled)return n(e);t(`Request: ${r.sanitize(e)}`);const o=await n(e);return t(`Response status code: ${o.status}`),t(`Headers: ${r.sanitize(o.headers)}`),o}}}({logger:ie.info,...e})}(e.loggingOptions),{afterPhase:"Sign"}),t;var r,n}function Ee(){const e=new C;return{async sendRequest(t){const{abortSignal:r,cleanup:n}=t.abortSignal?Ae(t.abortSignal):{};try{return t.abortSignal=r,await e.sendRequest(t)}finally{n?.()}}}}function xe(e){return i(e)}function Ce(e){return function(e){return new u(e)}(e)}const qe=(0,ae.KV)("core-rest-pipeline retryPolicy");function Oe(e,t={maxRetries:3}){return _(e,{logger:qe,...t})}const $e={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};const Te="bearerTokenAuthenticationPolicy";async function Le(e,t){try{return[await t(e),void 0]}catch(e){if(Re(e)&&e.response)return[e.response,e];throw e}}async function Me(e){const{scopes:t,getAccessToken:r,request:n}=e,o={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions,enableCae:!0},s=await r(t,o);s&&e.request.headers.set("Authorization",`Bearer ${s.token}`)}function Ie(e){return 401===e.status&&e.headers.has("WWW-Authenticate")}async function Ne(e,t){const{scopes:r}=e,n=await e.getAccessToken(r,{enableCae:!0,claims:t});return!!n&&(e.request.headers.set("Authorization",`${n.tokenType??"Bearer"} ${n.token}`),!0)}function ke(e){const{credential:t,scopes:r,challengeCallbacks:n}=e,o=e.logger||ie,s={authorizeRequest:n?.authorizeRequest?.bind(n)??Me,authorizeRequestOnChallenge:n?.authorizeRequestOnChallenge?.bind(n)},a=t?function(e,t){let r,n=null,o=null;const s={...$e,...t},a={get isRefreshing(){return null!==n},get shouldRefresh(){return!a.isRefreshing&&(!!(o?.refreshAfterTimestamp&&o.refreshAfterTimestamp<Date.now())||(o?.expiresOnTimestamp??0)-s.refreshWindowInMs<Date.now())},get mustRefresh(){return null===o||o.expiresOnTimestamp-s.forcedRefreshWindowInMs<Date.now()}};function i(t,i){return a.isRefreshing||(n=async function(e,t,r){async function n(){if(!(Date.now()<r)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch{return null}}let o=await n();for(;null===o;)await(0,he.cb)(t),o=await n();return o}(()=>e.getToken(t,i),s.retryIntervalInMs,o?.expiresOnTimestamp??Date.now()).then(e=>(n=null,o=e,r=i.tenantId,o)).catch(e=>{throw n=null,o=null,r=void 0,e})),n}return async(e,t)=>{const n=Boolean(t.claims),s=r!==t.tenantId;return n&&(o=null),s||n||a.mustRefresh?i(e,t):(a.shouldRefresh&&i(e,t),o)}}(t):()=>Promise.resolve(null);return{name:Te,async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let n,i,c;if(await s.authorizeRequest({scopes:Array.isArray(r)?r:[r],request:e,getAccessToken:a,logger:o}),[n,i]=await Le(e,t),Ie(n)){let u=De(n.headers.get("WWW-Authenticate"));if(u){let s;try{s=atob(u)}catch(e){return o.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${u}`),n}c=await Ne({scopes:Array.isArray(r)?r:[r],response:n,request:e,getAccessToken:a,logger:o},s),c&&([n,i]=await Le(e,t))}else if(s.authorizeRequestOnChallenge&&(c=await s.authorizeRequestOnChallenge({scopes:Array.isArray(r)?r:[r],request:e,response:n,getAccessToken:a,logger:o}),c&&([n,i]=await Le(e,t)),Ie(n)&&(u=De(n.headers.get("WWW-Authenticate")),u))){let s;try{s=atob(u)}catch(e){return o.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${u}`),n}c=await Ne({scopes:Array.isArray(r)?r:[r],response:n,request:e,getAccessToken:a,logger:o},s),c&&([n,i]=await Le(e,t))}}if(i)throw i;return n}}}function De(e){if(!e)return;const t=function(e){const t=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,r=/(\w+)="([^"]*)"/g,n=[];let o;for(;null!==(o=t.exec(e));){const e=o[1],t=o[2],s={};let a;for(;null!==(a=r.exec(t));)s[a[1]]=a[2];n.push({scheme:e,params:s})}return n}(e);return t.find(e=>"Bearer"===e.scheme&&e.params.claims&&"insufficient_claims"===e.params.error)?.params.claims}},61051(e,t,r){function n(e,t){const r=t.retryDelayInMs*Math.pow(2,e),n=Math.min(t.maxRetryDelayInMs,r);var o,s;return{retryAfterInMs:n/2+(o=0,s=n/2,o=Math.ceil(o),s=Math.floor(s),Math.floor(Math.random()*(s-o+1))+o)}}r.d(t,{g:()=>n})},67715(e,t,r){r.d(t,{gE:()=>i,cb:()=>s,u1:()=>a,bJ:()=>c,Ll:()=>u,qx:()=>l});var n=r(38414),o=r(42816);function s(e,t){let r;const{abortSignal:n,abortErrorMsg:s}=t??{};return function(t,n){const{cleanupBeforeAbort:s,abortSignal:a,abortErrorMsg:i}=n??{};return new Promise((t,n)=>{function c(){n(new o.l(i??"The operation was aborted."))}function u(){a?.removeEventListener("abort",l)}function l(){s?.(),u(),c()}if(a?.aborted)return c();try{(t=>{r=setTimeout(t,e)})(e=>{u(),t(e)})}catch(e){n(e)}a?.addEventListener("abort",l)})}(0,{cleanupBeforeAbort:()=>clearTimeout(r),abortSignal:n,abortErrorMsg:s??"The delay was aborted."})}function a(e){if((0,n.bJ)(e))return e.message;{let t;try{t="object"==typeof e&&e?JSON.stringify(e):String(e)}catch(e){t="[unable to stringify input]"}return`Unknown error ${t}`}}function i(e,t){return n.gE(e,t)}function c(e){return n.bJ(e)}n.Bd,n.Qg,n.N6;const u=n.qx,l=n.qx;n.tX,n.lV,n.p7},69325(e,t,r){r.d(t,{KV:()=>s,XM:()=>o});const n=(0,r(75666).MX)({logLevelEnvVarName:"AZURE_LOG_LEVEL",namespace:"azure"});function o(){return n.getLogLevel()}function s(e){return n.createClientLogger(e)}n.logger},70761(e,t,r){r.d(t,{b:()=>o});var n=r(81148);function o(e){if((0,n.G)(e)){const t="string"==typeof e.name,r="string"==typeof e.message;return t&&r}return!1}},75666(e,t,r){r.d(t,{KV:()=>E,MX:()=>A});var n=r(48161),o=r(57975),s=r(1708);const a="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0;let i,c=[],u=[];const l=[];a&&f(a);const d=Object.assign(e=>g(e),{enable:f,enabled:p,disable:function(){const e=i||"";return f(""),e},log:function(e,...t){s.stderr.write(`${o.format(e,...t)}${n.EOL}`)}});function f(e){i=e,c=[],u=[];const t=e.split(",").map(e=>e.trim());for(const e of t)e.startsWith("-")?u.push(e.substring(1)):c.push(e);for(const e of l)e.enabled=p(e.namespace)}function p(e){if(e.endsWith("*"))return!0;for(const t of u)if(h(e,t))return!1;for(const t of c)if(h(e,t))return!0;return!1}function h(e,t){if(-1===t.indexOf("*"))return e===t;let r=t;if(-1!==t.indexOf("**")){const e=[];let n="";for(const r of t)"*"===r&&"*"===n||(n=r,e.push(r));r=e.join("")}let n=0,o=0;const s=r.length,a=e.length;let i=-1,c=-1;for(;n<a&&o<s;)if("*"!==r[o]){if(r[o]!==e[n]){if(i>=0){if(o=i+1,n=c+1,n===a)return!1;for(;e[n]!==r[o];)if(n++,n===a)return!1;c=n,n++,o++;continue}return!1}o++,n++}else{if(i=o,o++,o===s)return!0;for(;e[n]!==r[o];)if(n++,n===a)return!1;c=n,n++,o++}const u=n===e.length,l=o===r.length,d=o===r.length-1&&"*"===r[o];return u&&(l||d)}function g(e){const t=Object.assign(function(...r){t.enabled&&(r.length>0&&(r[0]=`${e} ${r[0]}`),t.log(...r))},{enabled:p(e),destroy:y,log:d.log,namespace:e,extend:m});return l.push(t),t}function y(){const e=l.indexOf(this);return e>=0&&(l.splice(e,1),!0)}function m(e){const t=g(`${this.namespace}:${e}`);return t.log=this.log,t}const w=d,b=["verbose","info","warning","error"],v={verbose:400,info:300,warning:200,error:100};function R(e,t){t.log=(...t)=>{e.log(...t)}}function S(e){return b.includes(e)}function A(e){const t=new Set,r="undefined"!=typeof process&&process.env&&process.env[e.logLevelEnvVarName]||void 0;let n;const o=w(e.namespace);function s(e){if(e&&!S(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${b.join(",")}`);n=e;const r=[];for(const e of t)a(e)&&r.push(e.namespace);w.enable(r.join(","))}function a(e){return Boolean(n&&v[e.level]<=v[n])}function i(e,r){const n=Object.assign(e.extend(r),{level:r});if(R(e,n),a(n)){const e=w.disable();w.enable(e+","+n.namespace)}return t.add(n),n}return o.log=(...e)=>{w.log(...e)},r&&(S(r)?s(r):console.error(`${e.logLevelEnvVarName} set to unknown log level '${r}'; logging is not enabled. Acceptable values: ${b.join(", ")}.`)),{setLogLevel:s,getLogLevel:function(){return n},createClientLogger:function(e){const t=o.extend(e);return R(o,t),{error:i(t,"error"),warning:i(t,"warning"),info:i(t,"info"),verbose:i(t,"verbose")}},logger:o}}const P=A({logLevelEnvVarName:"TYPESPEC_RUNTIME_LOG_LEVEL",namespace:"typeSpecRuntime"});function E(e){return P.createClientLogger(e)}P.logger},81148(e,t,r){function n(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}r.d(t,{G:()=>n})},97247(e,t,r){r.d(t,{I:()=>i});var n=r(81148);const o="REDACTED",s=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],a=["api-version"];class i{allowedHeaderNames;allowedQueryParameters;constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=s.concat(e),t=a.concat(t),this.allowedHeaderNames=new Set(e.map(e=>e.toLowerCase())),this.allowedQueryParameters=new Set(t.map(e=>e.toLowerCase()))}sanitize(e){const t=new Set;return JSON.stringify(e,(e,r)=>{if(r instanceof Error)return{...r,name:r.name,message:r.message};if("headers"===e)return this.sanitizeHeaders(r);if("url"===e)return this.sanitizeUrl(r);if("query"===e)return this.sanitizeQuery(r);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(r)||(0,n.G)(r)){if(t.has(r))return"[Circular]";t.add(r)}return r}},2)}sanitizeUrl(e){if("string"!=typeof e||null===e||""===e)return e;const t=new URL(e);if(!t.search)return e;for(const[e]of t.searchParams)this.allowedQueryParameters.has(e.toLowerCase())||t.searchParams.set(e,o);return t.toString()}sanitizeHeaders(e){const t={};for(const r of Object.keys(e))this.allowedHeaderNames.has(r.toLowerCase())?t[r]=e[r]:t[r]=o;return t}sanitizeQuery(e){if("object"!=typeof e||null===e)return e;const t={};for(const r of Object.keys(e))this.allowedQueryParameters.has(r.toLowerCase())?t[r]=e[r]:t[r]=o;return t}}}};
//# sourceMappingURL=835.extension.js.map